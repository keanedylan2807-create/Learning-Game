<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Quiz: King of Speed</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+TC:wght@300;400;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #020205;
            color: #e0e0e0;
            overflow: hidden;
            height: 100vh;
        }

        .font-orbitron { font-family: 'Orbitron', sans-serif; }

        .road-container {
            perspective: 1200px;
            background: linear-gradient(to bottom, #020205 0%, #05051a 50%, #1a1a3a 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            position: relative;
            overflow: hidden;
            transition: background 1s ease;
        }

        /* City Skyline */
        .skyline {
            position: absolute;
            top: 15%;
            left: 0;
            width: 200%;
            height: 300px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='200' viewBox='0 0 400 200'%3E%3Cpath d='M0 200 L0 150 L30 150 L30 120 L60 120 L60 180 L90 180 L90 100 L130 100 L130 160 L160 160 L160 80 L210 80 L210 140 L250 140 L250 40 L300 40 L300 170 L340 170 L340 110 L380 110 L380 200 Z' fill='%230a0a2a'/%3E%3Crect x='100' y='120' width='5' height='5' fill='%233b82f6' opacity='0.5'/%3E%3Crect x='220' y='60' width='5' height='5' fill='%233b82f6' opacity='0.5'/%3E%3C/svg%3E");
            background-repeat: repeat-x;
            opacity: 0.4;
            animation: skyScroll 60s linear infinite;
            z-index: 1;
        }

        @keyframes skyScroll {
            from { transform: translateX(0); }
            to { transform: translateX(-50%); }
        }

        /* Highway */
        .highway {
            position: absolute;
            bottom: -500px;
            left: 50%;
            transform: translateX(-50%) rotateX(75deg);
            width: 3500px;
            height: 5000px;
            background: #050508;
            background-image: 
                linear-gradient(to top, rgba(59, 130, 246, 0.3) 2px, transparent 2px),
                linear-gradient(to right, rgba(59, 130, 246, 0.1) 1px, transparent 1px);
            background-size: 100% 250px, 200px 100%;
            animation: driveBackward var(--speed, 1.6s) linear infinite;
            animation-play-state: paused;
            transition: opacity 1s ease;
            z-index: 2;
        }

        .highway::before {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 100%;
            background: repeating-linear-gradient(to top, #facc15, #facc15 80px, transparent 80px, transparent 250px);
            filter: drop-shadow(0 0 10px #facc15);
        }

        .laser-rail {
            position: absolute;
            top: 0;
            width: 15px;
            height: 100%;
            background: #3b82f6;
            box-shadow: 0 0 40px #3b82f6, 0 0 10px #fff;
        }
        .rail-left { left: calc(50% - 400px); }
        .rail-right { right: calc(50% - 400px); }

        .highway.hyper {
            background-image: var(--hyper-bg);
            background-size: cover;
            background-position: center bottom;
            background-repeat: repeat-y;
            border: none;
            box-shadow: 0 0 100px rgba(255,255,255,0.1);
        }

        @keyframes driveBackward {
            from { background-position: 0 0; }
            to { background-position: 0 1000px; }
        }

        .driving .highway { animation-play-state: running; }
        .driving .car-sprite { animation: vibrate var(--vibe-speed, 0.1s) linear infinite; }

        @keyframes vibrate {
            0% { transform: translateX(-50%) translateZ(20px) translateY(0); }
            50% { transform: translateX(-50%) translateZ(20px) translateY(-2px); }
            100% { transform: translateX(-50%) translateZ(20px) translateY(0); }
        }

        .car-sprite {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%) translateZ(20px);
            z-index: 50;
            transition: all 0.5s cubic-bezier(0.2, 0, 0.2, 1);
            filter: drop-shadow(0 30px 25px rgba(0,0,0,0.9));
        }

        #activeCarSvg { width: 320px; overflow: visible; }

        .quiz-hub {
            position: absolute;
            top: 8%;
            left: 50%;
            transform: translateX(-50%) scale(0.9);
            width: 90%;
            max-width: 750px;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s cubic-bezier(0.19, 1, 0.22, 1);
        }

        .quiz-hub.active { opacity: 1; pointer-events: auto; transform: translateX(-50%) scale(1); }

        .glass-panel {
            background: rgba(8, 8, 20, 0.9);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(59, 130, 246, 0.3);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
        }

        #genLoader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 500;
            display: none;
            background: rgba(0,0,0,0.9);
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .speed-dash {
            position: absolute;
            bottom: 40px;
            right: 40px;
            z-index: 160;
            pointer-events: none;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .circular-gauge {
            width: 140px;
            height: 140px;
            position: relative;
        }

        .circular-gauge svg {
            transform: rotate(-90deg);
        }

        .gauge-bg {
            fill: none;
            stroke: rgba(59, 130, 246, 0.1);
            stroke-width: 8;
        }

        .gauge-fill {
            fill: none;
            stroke: #3b82f6;
            stroke-width: 8;
            stroke-dasharray: 377;
            stroke-dashoffset: 377;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease, stroke 0.5s ease;
            filter: drop-shadow(0 0 5px rgba(59, 130, 246, 0.8));
        }

        .gauge-needle {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 2px;
            height: 50px;
            background: #f43f5e;
            transform-origin: bottom center;
            transform: translate(-50%, -100%) rotate(-120deg);
            transition: transform 0.5s ease;
            box-shadow: 0 0 10px #f43f5e;
            border-radius: 2px;
        }

        .gauge-center {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 10px;
            height: 10px;
            background: #1e293b;
            border: 2px solid #3b82f6;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
        }

        .speed-text-container {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .speed-bar-mini {
            height: 3px;
            background: rgba(59, 130, 246, 0.2);
            width: 120px;
            margin-top: 8px;
            border-radius: 2px;
            overflow: hidden;
        }

        .speed-bar-fill {
            height: 100%;
            background: #3b82f6;
            width: 0%;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="min-h-screen">

    <div id="genLoader">
        <div class="w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div>
        <p class="text-blue-500 mt-6 font-orbitron tracking-widest text-sm uppercase">Optimizing Engine for Hyper Speed...</p>
    </div>

    <!-- Selection Screen -->
    <div id="selectionScreen" class="fixed inset-0 bg-[#020205] z-[200] flex flex-col items-center justify-center p-4">
        <div class="absolute top-8 right-8 flex gap-4">
            <button onclick="setLanguage('en')" id="btnEn" class="px-4 py-2 border border-blue-500 text-blue-500 rounded-full font-orbitron text-xs hover:bg-blue-500 hover:text-white transition-all bg-blue-500 text-white">EN</button>
            <button onclick="setLanguage('zh')" id="btnZh" class="px-4 py-2 border border-blue-500 text-blue-500 rounded-full font-orbitron text-xs hover:bg-blue-500 hover:text-white transition-all">繁中</button>
        </div>

        <h1 class="text-7xl md:text-8xl font-orbitron font-bold text-blue-500 mb-4 tracking-tighter italic text-center">CORE SELECT</h1>
        <p id="ui-init-driver" class="text-blue-400 mb-12 font-orbitron tracking-[0.5em] uppercase text-xs">Initialize Driver Protocol</p>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 w-full max-w-5xl">
            <button onclick="selectCar('Overclocker', '#f43f5e')" class="bg-gray-900/30 border border-gray-800 p-8 rounded-[2rem] flex flex-col items-center transition-all hover:scale-105 hover:border-red-500">
                <svg viewBox="0 0 120 70" class="w-32 mb-4"><path d="M10 50 L 25 20 L 95 20 L 110 50 Z" fill="#f43f5e"/><rect x="5" y="15" width="110" height="5" fill="#9f1239" /></svg>
                <h3 class="font-orbitron text-xl text-red-500">OVERCLOCKER</h3>
                <p id="car1-perk" class="text-[10px] mt-2 text-red-400 font-orbitron uppercase opacity-70">Extreme Velocity Tuning</p>
            </button>
            <button onclick="selectCar('CacheRunner', '#3b82f6')" class="bg-gray-900/30 border border-gray-800 p-8 rounded-[2rem] flex flex-col items-center transition-all hover:scale-105 hover:border-blue-500">
                <svg viewBox="0 0 120 70" class="w-32 mb-4"><path d="M10 50 L 25 20 L 95 20 L 110 50 Z" fill="#3b82f6"/><rect x="5" y="15" width="110" height="5" fill="#1e40af" /></svg>
                <h3 class="font-orbitron text-xl text-blue-500">CACHE RUNNER</h3>
                <p id="car2-perk" class="text-[10px] mt-2 text-blue-400 font-orbitron uppercase opacity-70">Balanced System Logic</p>
            </button>
            <button onclick="selectCar('Mainframe', '#a855f7')" class="bg-gray-900/30 border border-gray-800 p-8 rounded-[2rem] flex flex-col items-center transition-all hover:scale-105 hover:border-purple-500">
                <svg viewBox="0 0 120 70" class="w-32 mb-4"><path d="M10 50 L 25 20 L 95 20 L 110 50 Z" fill="#a855f7"/><rect x="5" y="15" width="110" height="5" fill="#6b21a8" /></svg>
                <h3 class="font-orbitron text-xl text-purple-500">MAINFRAME</h3>
                <p id="car3-perk" class="text-[10px] mt-2 text-purple-400 font-orbitron uppercase opacity-70">High Capacity Processing</p>
            </button>
        </div>
    </div>

    <!-- Game World -->
    <div id="gameWorld" class="road-container">
        <div class="skyline"></div>
        <div class="highway" id="highway">
            <div class="laser-rail rail-left"></div>
            <div class="laser-rail rail-right"></div>
        </div>

        <!-- HUD -->
        <div class="absolute top-0 left-0 w-full p-8 z-[150] flex justify-between items-start pointer-events-none">
            <div>
                <div class="text-blue-500 font-orbitron font-bold text-3xl italic">SPEED QUIZ</div>
                <div id="carStatus" class="mt-2 text-[10px] bg-blue-900/40 border border-blue-500/30 px-3 py-1 rounded-full font-orbitron text-blue-300 uppercase">LINK: ACQUIRING...</div>
            </div>
            <div class="flex gap-4">
                <div class="glass-panel px-6 py-4 rounded-3xl text-center border-blue-500/50">
                    <div id="ui-nodes" class="text-[9px] text-blue-500 font-orbitron tracking-widest uppercase">DATA NODES</div>
                    <div id="progressCount" class="text-2xl font-orbitron text-white">0%</div>
                </div>
                <div class="glass-panel px-6 py-4 rounded-3xl text-center border-yellow-500/50">
                    <div id="ui-velocity" class="text-[9px] text-yellow-600 font-orbitron tracking-widest uppercase">PROGRESS</div>
                    <div id="gearDisplay" class="text-2xl font-orbitron text-yellow-500">000</div>
                </div>
            </div>
        </div>

        <!-- Speedometer Dashboard -->
        <div class="speed-dash">
            <div class="circular-gauge">
                <svg width="140" height="140">
                    <circle class="gauge-bg" cx="70" cy="70" r="60" stroke-dasharray="282.7" stroke-dashoffset="0"></circle>
                    <circle id="gaugeProgress" class="gauge-fill" cx="70" cy="70" r="60"></circle>
                </svg>
                <div class="gauge-center"></div>
                <div id="gaugeNeedle" class="gauge-needle"></div>
            </div>
            <div class="speed-text-container">
                <div class="flex items-baseline gap-2">
                    <span id="kmphValue" class="text-5xl font-orbitron font-bold text-white italic">0</span>
                    <span class="text-xs font-orbitron text-blue-400 font-bold">KM/H</span>
                </div>
                <div class="flex items-baseline gap-1 -mt-1">
                    <span id="mphValue" class="text-xl font-orbitron text-gray-400">0</span>
                    <span class="text-[10px] font-orbitron text-gray-500">MPH</span>
                </div>
                <div class="speed-bar-mini">
                    <div id="speedFill" class="speed-bar-fill"></div>
                </div>
            </div>
        </div>

        <div id="quizHub" class="quiz-hub">
            <div class="glass-panel p-10 rounded-[3rem] relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-1 bg-blue-950">
                    <div id="progressBar" class="bg-blue-400 h-full transition-all duration-700" style="width: 0%"></div>
                </div>
                <div class="mb-6">
                    <p class="text-blue-500 font-orbitron text-[10px] tracking-widest mb-1"><span id="ui-terminal-label">TERMINAL ACCESS</span> #<span id="nodeNum">01</span></p>
                    <h3 id="questionText" class="text-2xl font-bold text-white leading-snug">Decrypting node...</h3>
                </div>
                <div id="optionsContainer" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                <div id="feedback" class="mt-8 text-center font-orbitron text-xs font-bold tracking-[0.3em] uppercase h-5"></div>
            </div>
        </div>

        <div id="carSprite" class="car-sprite">
            <svg id="activeCarSvg" viewBox="0 0 120 80">
                <defs><filter id="neonGlow"><feGaussianBlur stdDeviation="2" result="coloredBlur"/><feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs>
                <rect x="5" y="45" width="25" height="25" fill="#080808" rx="2" /><rect x="90" y="45" width="25" height="25" fill="#080808" rx="2" />
                <path d="M20 55 L 100 55 L 110 70 L 10 70 Z" fill="#0a0a0a" />
                <path id="carBodyColor" d="M10 55 L 25 25 L 95 25 L 110 55 Z" fill="#3b82f6" />
                <path d="M30 28 L 90 28 L 85 40 L 35 40 Z" fill="#020617" opacity="0.9" />
                <path d="M5 20 L 115 20 L 115 25 L 5 25 Z" fill="#1e3a8a" id="spoilerColor" />
                <rect x="15" y="42" width="25" height="8" fill="#7f1d1d" rx="1" id="leftLight" filter="url(#neonGlow)" />
                <rect x="80" y="42" width="25" height="8" fill="#7f1d1d" rx="1" id="rightLight" filter="url(#neonGlow)" />
            </svg>
        </div>
    </div>

    <!-- Modals -->
    <div id="victoryModal" class="fixed inset-0 bg-black/98 z-[300] hidden flex items-center justify-center p-6 text-center">
        <div class="max-w-3xl">
            <h2 id="ui-finish" class="text-7xl font-orbitron text-blue-500 mb-4 italic font-bold">MISSION SUCCESS</h2>
            <p id="ui-race-complete" class="text-xl text-blue-300 font-light mb-12 tracking-[0.5em] uppercase">Hyper Drive Maintained</p>
            <button onclick="location.reload()" id="ui-restart" class="border border-blue-500 text-blue-500 hover:bg-blue-500 hover:text-white font-orbitron px-12 py-4 rounded-full transition-all text-xs uppercase">Restart</button>
        </div>
    </div>

    <div id="failModal" class="fixed inset-0 bg-black/98 z-[300] hidden flex items-center justify-center p-6 text-center">
        <div class="max-w-3xl">
            <h2 id="ui-failed" class="text-7xl font-orbitron text-red-600 mb-4 italic font-bold">MISSION FAILED</h2>
            <p id="ui-too-slow" class="text-xl text-red-400 font-light mb-12 tracking-[0.5em] uppercase">Speed dropped below Hyper Threshold</p>
            <button onclick="location.reload()" class="border border-red-600 text-red-600 hover:bg-red-600 hover:text-white font-orbitron px-12 py-4 rounded-full transition-all text-xs uppercase">Re-Initialize</button>
        </div>
    </div>

    <script>
        const apiKey = "";
        
        // --- AUDIO ENGINE ---
        const AudioEngine = {
            ctx: null,
            engineOsc: null,
            engineGain: null,
            
            init() {
                if (this.ctx) return;
                this.ctx = new (window.AudioContext || window.webkitAudioContext)();
                
                // Set up continuous engine hum
                this.engineOsc = this.ctx.createOscillator();
                this.engineOsc.type = 'sawtooth';
                this.engineOsc.frequency.setValueAtTime(40, this.ctx.currentTime);
                
                this.engineGain = this.ctx.createGain();
                this.engineGain.gain.setValueAtTime(0.05, this.ctx.currentTime);
                
                const lpf = this.ctx.createBiquadFilter();
                lpf.type = 'lowpass';
                lpf.frequency.setValueAtTime(400, this.ctx.currentTime);
                
                this.engineOsc.connect(lpf);
                lpf.connect(this.engineGain);
                this.engineGain.connect(this.ctx.destination);
                this.engineOsc.start();
            },

            updateEngine(speed) {
                if (!this.ctx) return;
                // Pitch rises from 40Hz to 180Hz based on speed
                const freq = 40 + (speed / 400) * 140;
                this.engineOsc.frequency.setTargetAtTime(freq, this.ctx.currentTime, 0.1);
                // Volume slight increase with speed
                this.engineGain.gain.setTargetAtTime(0.05 + (speed / 400) * 0.05, this.ctx.currentTime, 0.1);
            },

            playSuccess() {
                if (!this.ctx) return;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = 'sine';
                osc.frequency.setValueAtTime(440, this.ctx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(880, this.ctx.currentTime + 0.2);
                gain.gain.setValueAtTime(0.2, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.3);
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start();
                osc.stop(this.ctx.currentTime + 0.3);
            },

            playFail() {
                if (!this.ctx) return;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = 'square';
                osc.frequency.setValueAtTime(150, this.ctx.currentTime);
                osc.frequency.linearRampToValueAtTime(70, this.ctx.currentTime + 0.4);
                gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
                gain.gain.linearRampToValueAtTime(0.01, this.ctx.currentTime + 0.4);
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start();
                osc.stop(this.ctx.currentTime + 0.4);
            },

            playHyper() {
                if (!this.ctx) return;
                const noise = this.ctx.createBufferSource();
                const bufferSize = this.ctx.sampleRate * 2;
                const buffer = this.ctx.createBuffer(1, bufferSize, this.ctx.sampleRate);
                const data = buffer.getChannelData(0);
                for (let i = 0; i < bufferSize; i++) data[i] = Math.random() * 2 - 1;
                noise.buffer = buffer;
                
                const filter = this.ctx.createBiquadFilter();
                filter.type = 'highpass';
                filter.frequency.setValueAtTime(1000, this.ctx.currentTime);
                filter.frequency.exponentialRampToValueAtTime(5000, this.ctx.currentTime + 1);
                
                const gain = this.ctx.createGain();
                gain.gain.setValueAtTime(0.3, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 1.5);
                
                noise.connect(filter);
                filter.connect(gain);
                gain.connect(this.ctx.destination);
                noise.start();
            }
        };

        const translations = {
            en: {
                init: "Initialize Driver Protocol",
                nodes: "DATA NODES",
                velocity: "PROGRESS",
                terminal: "TERMINAL ACCESS",
                finish: "MISSION SUCCESS",
                raceComplete: "Hyper Drive Maintained",
                restart: "Restart",
                failed: "MISSION FAILED",
                tooSlow: "Speed dropped below Hyper Threshold",
                breached: ">> NODE BREACHED - BOOSTING",
                stall: "!! SYSTEM STALL - SPEED LOSS !!",
                decrypting: "Decrypting node...",
                car: "CAR"
            },
            zh: {
                init: "初始化駕駛員協定",
                nodes: "數據節節點",
                velocity: "進度點",
                terminal: "終端存取",
                finish: "任務成功",
                raceComplete: "超光速推進維持成功",
                restart: "重新啟動",
                failed: "任務失敗",
                tooSlow: "速度低於超光速臨界值",
                breached: ">> 節點破解成功 - 加速中",
                stall: "!! 系統停擺 - 速度下降 !!",
                decrypting: "解密節點中...",
                car: "車輛"
            }
        };

        const questionsDB = {
            en: [
                { q: "Heart of computer, CU + ALU?", options: ["RAM", "CPU", "Input", "SSD"], correct: 1 },
                { q: "Barcode Reader type?", options: ["Output", "Storage", "Input", "Memory"], correct: 2 },
                { q: "Best computer performance?", options: ["Supercomputer", "PC", "Workstation", "Server"], correct: 0 },
                { q: "ODF extension for Presentation?", options: [".ppt", ".odt", ".odp", ".ods"], correct: 2 },
                { q: "Windows icon that can't be deleted?", options: ["Network", "User", "Recycle Bin", "Desktop"], correct: 2 },
                { q: "Communication rules?", options: ["Protocols", "Firmware", "Laws", "Software"], correct: 0 },
                { q: "Best virus prevention?", options: ["No HDD", "Licensed Software", "Public BBS", "Piracy"], correct: 1 },
                { q: "Fundamental Ransomware defense?", options: ["Offline Backup", "Anti-virus", "Pay Ransom", "Cloud Sync"], correct: 0 },
                { q: "Software managing resources?", options: ["App", "OS", "Driver", "Firmware"], correct: 1 },
                { q: "Fastest retrieval type?", options: ["HDD", "RAM", "Cache", "Flash"], correct: 2 },
                { q: "What does 'HTTP' stand for?", options: ["High Text Transfer", "Hypertext Transfer Protocol", "Home Tool Transfer", "Hyper Tool Protocol"], correct: 1 },
                { q: "Default port for HTTPS?", options: ["80", "21", "443", "8080"], correct: 2 },
                { q: "Binary for decimal 5?", options: ["101", "111", "011", "110"], correct: 0 },
                { q: "A kilobyte is how many bytes?", options: ["1000", "1024", "2048", "512"], correct: 1 },
                { q: "Brain of the robot?", options: ["Motor", "Sensor", "Controller", "Actuator"], correct: 2 },
                { q: "Who created Linux kernel?", options: ["Bill Gates", "Linus Torvalds", "Steve Jobs", "Mark Zuckerberg"], correct: 1 },
                { q: "Python extension name?", options: [".pt", ".py", ".pyt", ".python"], correct: 1 },
                { q: "HTML tag for a link?", options: ["<link>", "<a>", "<url>", "<href>"], correct: 1 },
                { q: "CSS stands for?", options: ["Creative Style Sheets", "Cascading Style Sheets", "Computer Style Sheets", "Colorful Style Sheets"], correct: 1 },
                { q: "JS standard name?", options: ["Java", "ES6", "ECMAScript", "C Script"], correct: 2 },
                { q: "Main storage in modern PC?", options: ["Floppy", "SSD", "Tape", "L1 Cache"], correct: 1 },
                { q: "Largest social network?", options: ["X", "Facebook", "Instagram", "Snapchat"], correct: 1 },
                { q: "SQL used for?", options: ["Styling", "Databases", "Networking", "Printing"], correct: 1 },
                { q: "First web browser?", options: ["Mosaic", "WorldWideWeb", "Netscape", "IE"], correct: 1 },
                { q: "Mac OS based on?", options: ["Windows", "Unix", "MS-DOS", "OS/2"], correct: 1 },
                { q: "IP stands for?", options: ["Internal Process", "Internet Protocol", "Internet Path", "Intranet Port"], correct: 1 },
                { q: "Cloud storage service from Apple?", options: ["Drive", "iCloud", "DropBox", "OneDrive"], correct: 1 },
                { q: "What is 'Ping' used for?", options: ["Audio test", "Connection latency", "Download speed", "Virus check"], correct: 1 },
                { q: "Short range wireless?", options: ["Wi-Fi", "4G", "Bluetooth", "NFC"], correct: 2 },
                { q: "GPU primary task?", options: ["Text", "Physics", "Graphics", "Math"], correct: 2 },
                { q: "World's most used mobile OS?", options: ["iOS", "Android", "Windows", "Harmony"], correct: 1 },
                { q: "Company owning Android?", options: ["Apple", "Samsung", "Microsoft", "Google"], correct: 3 },
                { q: "Common email protocol?", options: ["SMTP", "UDP", "FTP", "SSH"], correct: 0 },
                { q: "What is a 'Bug'?", options: ["Hardware virus", "Software error", "Antenna", "User error"], correct: 1 },
                { q: "Open source license?", options: ["Proprietary", "MIT", "Copyright", "EULA"], correct: 1 },
                { q: "WIFI standard?", options: ["802.11", "802.3", "IPv6", "GSM"], correct: 0 },
                { q: "ASCII is used for?", options: ["Math", "Text encoding", "Video", "Color"], correct: 1 },
                { q: "Computer's temporary workspace?", options: ["ROM", "RAM", "BIOS", "BIOS"], correct: 1 },
                { q: "Universal connector?", options: ["VGA", "USB", "Serial", "Parallel"], correct: 1 },
                { q: "Encryption key?", options: ["Password", "Hash", "Cipher", "Symmetric"], correct: 2 },
                { q: "AI technique mimicking brain?", options: ["Big Data", "Neural Networks", "Sorting", "Regressions"], correct: 1 },
                { q: "Main frame color of Google Logo?", options: ["Red", "Blue", "Green", "White"], correct: 1 },
                { q: "Software as a Service?", options: ["IaaS", "PaaS", "SaaS", "DaaS"], correct: 2 },
                { q: "A nibble is how many bits?", options: ["2", "4", "8", "16"], correct: 1 },
                { q: "Domain for education?", options: [".com", ".net", ".edu", ".org"], correct: 2 },
                { q: "Search engine in China?", options: ["Google", "Baidu", "Yandex", "Bing"], correct: 1 },
                { q: "Input for sound?", options: ["Monitor", "Mouse", "Microphone", "Printer"], correct: 2 },
                { q: "Standard video format?", options: ["MP3", "MP4", "WAV", "TXT"], correct: 1 },
                { q: "What is IoT?", options: ["Internet of Tasks", "Internet of Things", "Internal Online Tech", "Input output tool"], correct: 1 },
                { q: "Language of the Web?", options: ["Java", "C++", "JavaScript", "Python"], correct: 2 }
            ],
            zh: [
                { q: "電腦的心臟，由控制單元與算術邏輯單元組成？", options: ["RAM", "CPU", "輸入設備", "SSD"], correct: 1 },
                { q: "條碼閱讀機屬於下列何者？", options: ["輸出設備", "儲存設備", "輸入設備", "記憶設備"], correct: 2 },
                { q: "下列何種類型的電腦效能最佳？", options: ["超級電腦", "個人電腦", "工作站", "伺服器"], correct: 0 },
                { q: "開放文檔格式 (ODF) 規範的簡報檔案副檔名？", options: [".ppt", ".odt", ".odp", ".ods"], correct: 2 },
                { q: "在 Windows 中，下列何種圖示不能被刪除？", options: ["網路", "使用者文件", "資源回收筒", "本機"], correct: 2 },
                { q: "電腦網路通訊時，雙方必須遵守的規則稱之為？", options: ["通訊協定", "韌體", "法律", "應用軟體"], correct: 0 },
                { q: "預防病毒感染的最佳途徑？", options: ["不安裝硬碟", "使用原版軟體", "由 BBS 擷取程式", "使用盜版"], correct: 1 },
                { q: "解決勒索病毒最根本的方法？", options: ["定期離線備份", "安裝防毒軟體", "支付贖金", "雲端同步"], correct: 0 },
                { q: "負責管理及配置電腦資源的系統軟體？", options: ["應用程式", "作業系統", "驅動程式", "韌體"], correct: 1 },
                { q: "下列哪種類型的記憶體存取速度最快？", options: ["HDD", "RAM", "快取記憶體", "隨身碟"], correct: 2 },
                { q: "HTTP 代表什麼？", options: ["超文字傳輸協定", "高文字工具", "家庭工具協定", "高速傳輸"], correct: 0 },
                { q: "HTTPS 的預設連接埠？", options: ["80", "21", "443", "8080"], correct: 2 },
                { q: "十進位 5 的二進位？", options: ["101", "111", "011", "110"], correct: 0 },
                { q: "1 KB 等於多少位元組？", options: ["1000", "1024", "2048", "512"], correct: 1 },
                { q: "機器人的大腦？", options: ["馬達", "感應器", "控制器", "致動器"], correct: 2 },
                { q: "誰開發了 Linux 核心？", options: ["比爾蓋茲", "林納斯·托瓦茲", "賈伯斯", "祖克柏"], correct: 1 },
                { q: "Python 副檔名？", options: [".pt", ".py", ".pyt", ".python"], correct: 1 },
                { q: "HTML 的超連結標籤？", options: ["<link>", "<a>", "<url>", "<href>"], correct: 1 },
                { q: "CSS 是什麼的縮寫？", options: ["創意樣式表", "階層式樣式表", "電腦樣式表", "彩色樣式表"], correct: 1 },
                { q: "JS 標準名稱？", options: ["Java", "ES6", "ECMAScript", "C Script"], correct: 2 },
                { q: "現代電腦主要儲存裝置？", options: ["軟碟", "SSD", "磁帶", "L1 快取"], correct: 1 },
                { q: "最大的社交網路？", options: ["X", "Facebook", "Instagram", "Snapchat"], correct: 1 },
                { q: "SQL 用於？", options: ["樣式", "資料庫", "網路", "列印"], correct: 1 },
                { q: "第一個網頁瀏覽器？", options: ["Mosaic", "WorldWideWeb", "Netscape", "IE"], correct: 1 },
                { q: "Mac OS 基於什麼系統？", options: ["Windows", "Unix", "MS-DOS", "OS/2"], correct: 1 },
                { q: "IP 代表什麼？", options: ["內部程序", "網際網路協定", "網路路徑", "內網埠"], correct: 1 },
                { q: "Apple 的雲端儲存？", options: ["Drive", "iCloud", "DropBox", "OneDrive"], correct: 1 },
                { q: "Ping 用於？", options: ["音效測試", "連線延遲", "下載速度", "病毒檢查"], correct: 1 },
                { q: "短距離無線技術？", options: ["Wi-Fi", "4G", "藍牙", "NFC"], correct: 2 },
                { q: "GPU 主要任務？", options: ["文字", "物理", "繪圖", "數學"], correct: 2 },
                { q: "世界最多人使用的手機 OS？", options: ["iOS", "Android", "Windows", "Harmony"], correct: 1 },
                { q: "擁有 Android 的公司？", options: ["Apple", "Samsung", "Microsoft", "Google"], correct: 3 },
                { q: "常用的郵件傳送協定？", options: ["SMTP", "UDP", "FTP", "SSH"], correct: 0 },
                { q: "什麼是 Bug？", options: ["硬體病毒", "軟體錯誤", "天線", "使用者操作"], correct: 1 },
                { q: "開源授權合約？", options: ["私有軟體", "MIT", "著作權", "EULA"], correct: 1 },
                { q: "WIFI 的通訊標準？", options: ["802.11", "802.3", "IPv6", "GSM"], correct: 0 },
                { q: "ASCII 用於？", options: ["數學", "文字編碼", "影片", "顏色"], correct: 1 },
                { q: "電腦的臨時工作空間？", options: ["ROM", "RAM", "BIOS", "硬碟"], correct: 1 },
                { q: "萬用連接介面？", options: ["VGA", "USB", "串列埠", "並列埠"], correct: 1 },
                { q: "加密演算法？", options: ["密碼", "雜湊", "密碼法", "對稱"], correct: 2 },
                { q: "模擬大腦的 AI 技術？", options: ["大數據", "類神經網路", "排序", "回歸"], correct: 1 },
                { q: "Google Logo 的主色調之一？", options: ["紅色", "藍色", "綠色", "白色"], correct: 1 },
                { q: "軟體即服務？", options: ["IaaS", "PaaS", "SaaS", "DaaS"], correct: 2 },
                { q: "半個位元組 (nibble) 是幾個位元？", options: ["2", "4", "8", "16"], correct: 1 },
                { q: "教育機構的網域？", options: [".com", ".net", ".edu", ".org"], correct: 2 },
                { q: "中國最大的搜尋引擎？", options: ["Google", "Baidu", "Yandex", "Bing"], correct: 1 },
                { q: "聲音輸入設備？", options: ["螢幕", "滑鼠", "麥克風", "印表機"], correct: 2 },
                { q: "常見影片格式？", options: ["MP3", "MP4", "WAV", "TXT"], correct: 1 },
                { q: "什麼是 IoT？", options: ["任務網", "物聯網", "內部網", "輸入工具"], correct: 1 },
                { q: "網頁開發的核心語言？", options: ["Java", "C++", "JavaScript", "Python"], correct: 2 }
            ]
        };

        let lang = 'en';
        let currentIdx = 0;
        let kmh = 0;
        let selectedCarType = '';
        let isHyperMode = false;
        let hyperReached = false;
        let shuffledQuestions = [];

        function shuffleArray(array) {
            const newArr = [...array];
            for (let i = newArr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArr[i], newArr[j]] = [newArr[j], newArr[i]];
            }
            return newArr;
        }

        function setLanguage(l) {
            lang = l;
            const t = translations[l];
            document.getElementById('ui-init-driver').innerText = t.init;
            document.getElementById('ui-nodes').innerText = t.nodes;
            document.getElementById('ui-velocity').innerText = t.velocity;
            document.getElementById('ui-terminal-label').innerText = t.terminal;
            document.getElementById('questionText').innerText = t.decrypting;
            document.getElementById('ui-finish').innerText = t.finish;
            document.getElementById('ui-race-complete').innerText = t.raceComplete;
            document.getElementById('ui-restart').innerText = t.restart;
            document.getElementById('ui-failed').innerText = t.failed;
            document.getElementById('ui-too-slow').innerText = t.tooSlow;
        }

        async function generateHyperMap() {
            const loader = document.getElementById('genLoader');
            loader.style.display = 'flex';
            const prompt = "ultra-realistic first-person cockpit view of a car traveling at warp speed through a neon cyberpunk city, motion blur, streaks of light, futuristic technology, cinematic lighting, 8k";
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        instances: [{ prompt: prompt }],
                        parameters: { sampleCount: 1 }
                    })
                });
                const result = await response.json();
                if (result.predictions && result.predictions[0]) {
                    const imageUrl = `data:image/png;base64,${result.predictions[0].bytesBase64Encoded}`;
                    const highway = document.getElementById('highway');
                    highway.style.setProperty('--hyper-bg', `url(${imageUrl})`);
                    highway.classList.add('hyper');
                    AudioEngine.playHyper(); // Sound cue for hyper mode
                }
            } catch (error) {
                console.error("Image generation failed:", error);
            } finally {
                loader.style.display = 'none';
            }
        }

        function selectCar(type, color) {
            AudioEngine.init(); // Initialize audio on user interaction
            selectedCarType = type;
            document.getElementById('selectionScreen').classList.add('hidden');
            document.getElementById('carBodyColor').setAttribute('fill', color);
            document.getElementById('carStatus').innerText = `${translations[lang].car}: ${type}`;
            shuffledQuestions = shuffleArray(questionsDB[lang]);
            kmh = 80;
            startDrive();
        }

        function updateVelocityHUD() {
            const mph = Math.round(kmh * 0.621371);
            AudioEngine.updateEngine(kmh); // Update engine sound pitch
            
            document.getElementById('kmphValue').innerText = Math.round(kmh);
            document.getElementById('mphValue').innerText = mph;
            
            const percentage = Math.min(100, (kmh / 400) * 100);
            document.getElementById('speedFill').style.width = `${percentage}%`;

            const radius = 60;
            const circumference = 2 * Math.PI * radius;
            const gaugeLimit = circumference * 0.75; 
            const offset = circumference - (percentage / 100) * gaugeLimit;
            document.getElementById('gaugeProgress').style.strokeDashoffset = offset;
            
            const rotation = -120 + (percentage / 100) * 240;
            document.getElementById('gaugeNeedle').style.transform = `translate(-50%, -100%) rotate(${rotation}deg)`;
            
            if (kmh >= 250) {
                document.getElementById('gaugeProgress').style.stroke = '#f43f5e';
                if (!isHyperMode) {
                    isHyperMode = true;
                    hyperReached = true;
                    generateHyperMap();
                }
            } else {
                document.getElementById('gaugeProgress').style.stroke = '#3b82f6';
            }

            const animSpeed = 1.6 - ((Math.min(400, kmh) - 80) / 320) * 1.5;
            document.getElementById('highway').style.setProperty('--speed', `${animSpeed}s`);
            document.getElementById('gearDisplay').innerText = String(currentIdx + 1).padStart(3, '0');
        }

        function startDrive() {
            document.body.classList.add('driving');
            updateVelocityHUD();
            document.getElementById('progressCount').innerText = Math.round((currentIdx / shuffledQuestions.length) * 100) + '%';
            document.getElementById('leftLight').setAttribute('fill', '#ef4444');
            document.getElementById('rightLight').setAttribute('fill', '#ef4444');
            setTimeout(showQuestion, 1500);
        }

        function showQuestion() {
            document.body.classList.remove('driving');
            if (currentIdx >= shuffledQuestions.length) {
                finishRace();
                return;
            }

            const q = shuffledQuestions[currentIdx];
            document.getElementById('nodeNum').innerText = String(currentIdx + 1).padStart(2, '0');
            document.getElementById('questionText').innerText = q.q;
            document.getElementById('progressBar').style.width = `${((currentIdx) / shuffledQuestions.length) * 100}%`;
            
            const container = document.getElementById('optionsContainer');
            container.innerHTML = '';
            
            q.options.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = "p-4 rounded-2xl bg-white/5 hover:bg-blue-600/20 border border-white/10 transition-all font-orbitron text-[10px] tracking-widest text-left";
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(i);
                container.appendChild(btn);
            });

            document.getElementById('quizHub').classList.add('active');
            document.getElementById('feedback').innerText = '';
        }

        function checkAnswer(idx) {
            const q = shuffledQuestions[currentIdx];
            const correct = q.correct === idx;
            const t = translations[lang];

            if (correct) {
                AudioEngine.playSuccess();
                currentIdx++;
                kmh = Math.min(400, kmh + 20);
                document.getElementById('feedback').innerText = t.breached;
                document.getElementById('feedback').className = "mt-8 text-center font-orbitron text-xs font-bold tracking-[0.3em] uppercase h-5 text-blue-400";
                
                setTimeout(() => {
                    document.getElementById('quizHub').classList.remove('active');
                    if (currentIdx < shuffledQuestions.length) {
                        startDrive();
                    } else {
                        finishRace();
                    }
                }, 800);
            } else {
                AudioEngine.playFail();
                kmh = Math.max(40, kmh - 35);
                document.getElementById('feedback').innerText = t.stall;
                document.getElementById('feedback').className = "mt-8 text-center font-orbitron text-xs font-bold tracking-[0.3em] uppercase h-5 text-red-500";
                updateVelocityHUD();
            }
        }

        function finishRace() { 
            document.getElementById('quizHub').classList.remove('active');
            if (kmh >= 250) {
                document.getElementById('victoryModal').classList.remove('hidden');
            } else {
                document.getElementById('failModal').classList.remove('hidden');
            }
            kmh = 450;
            updateVelocityHUD();
            document.body.classList.add('driving');
        }

        window.onload = () => {
            setLanguage('en');
        };
    </script>
</body>
</html>
